#!/usr/bin/env python

try:
    import os
    import sys
    import argparse
    import subprocess
    from fake_useragent import UserAgent
except ImportError, err:
    print >> sys.stderr, "Error: {0}".format()
    sys.exit(1)


class Nikto(object):

        def __init__(self):

                usage = "Usage: use --help for further information"
                description = "Auto Nikto "
                parser = argparse.ArgumentParser(description = description, usage = usage)

                parser.add_argument('-d', '--domain_file', dest = 'domain_file', action = 'store', help = 'Domains File', required = True)

                args = parser.parse_args()
                self.__domain_files = args.domain_file

                if not os.path.exists(self.__domain_files):
                        print >> sys.stderr, "File: {0} Doesn't Exists".format(self.__domain_files)
                        sys.exit(1)


                self.__useragent = UserAgent()


        def _run(self):
                
                for domain in open(self.__domain_files, "r"):
                        url = "http://{0}/".format(domain.strip())
                        output_file = "{0}-result.htm".format(domain.strip())
                        proc = subprocess.Popen(["nikto", "-host", url, "-port" , "80", "-Format", "htm", "-output", output_file, "-useragent", "\"{0}\"".format(self.__useragent.random), "-maxtime", "3600", "-Cgidirs", "all" ], shell = False,  stdout = subprocess.PIPE, stderr = subprocess.PIPE, ).communicate()


if __name__ == "__main__":
        nikto = Nikto()
        nikto._run()
